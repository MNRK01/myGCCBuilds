--- configure.ac.orig	2022-09-15 00:48:19.941482900 -0500
+++ configure.ac	2022-09-15 12:21:43.589058600 -0500
@@ -3402,8 +3402,13 @@
     with_system_ffi="yes"
 fi
 
-if test "$with_system_ffi" = "yes" && test -n "$PKG_CONFIG"; then
+if test "$with_system_ffi" = "yes" && test -n "$PKG_CONFIG" && test -z "${GCC_VER+set}" ; then
     LIBFFI_INCLUDEDIR="`"$PKG_CONFIG" libffi --cflags-only-I 2>/dev/null | sed -e 's/^-I//;s/ .*$//'`"
+elif test "$with_system_ffi" = "yes" && test -n "$PKG_CONFIG" && test -n "${GCC_VER+set}" ; then
+    # arkay7777 - we are using a just-built libffi and not the system ffi. the above code forces $with_system_ffi = yes
+    # and then the code below uses $PKG_CONFIG to try to find the system_ffi. this is incorrect, $LIBFFI_INCLUDEDIR is
+    # specified in the configure script call
+    :
 else
     LIBFFI_INCLUDEDIR=""
 fi
